<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mermaid 示例</title>
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Ctext y='14' font-size='14'%3E%F0%9F%93%84%3C/text%3E%3C/svg%3E">
</head>
<body>
  <h1>Mermaid 示例页面</h1>
  <p>此页面用于验证本地优先的 Mermaid 加载与 GitHub Pages 托管。</p>

  <div class="mermaid">
    flowchart TD
      A[开始] --> B{条件}
      B -->|是| C[执行步骤1]
      B -->|否| D[执行步骤2]
      C --> E[结束]
      D --> E
  </div>

  <script type="module">
    (async () => {
      async function loadMermaid() {
        try {
          const mod = await import('./vendor/mermaid.esm.min.mjs');
          return mod.default || mod.mermaid || mod;
        } catch (_) {}
        const urls = [
          'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs',
          'https://unpkg.com/mermaid@10/dist/mermaid.esm.min.mjs',
          'https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.esm.min.mjs'
        ];
        for (const url of urls) {
          try {
            const mod = await import(url);
            return mod.default || mod.mermaid || mod;
          } catch (_) {}
        }
        throw new Error('Mermaid 加载失败');
      }
      const mer = await loadMermaid();
      mer.initialize({ startOnLoad: false, theme: 'default' });
      const nodes = Array.from(document.querySelectorAll('.mermaid'));
      try {
        mer.run({ nodes });
      } catch (e) {
        mer.init(undefined, nodes);
      }
    })();
  </script>
</body>
</html>
